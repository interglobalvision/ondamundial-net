{"version":3,"sources":["main.js"],"names":["$","document","ready","Player","Vue","el","data","streamUrl","isStreaming","isPlaying","message","stream","event","fftSize","freqBand","repeatMarquee","computed","marqueeText","this","title","current_track","marqueeWidth","updated","getElementById","offsetWidth","watch","methods","checkStatus","get","res","status","initPlayer","bind","checkEvent","WP","siteUrl","audio","Howl","src","html5","format","on","play","Number","volume","audioAnalyser","Howler","ctx","createAnalyser","smoothingTimeConstant","analyserData","Uint8Array","frequencyBinCount","masterGain","connect","gain","value","destination","toggleMute","getAnalyserValue","getByteTimeDomainData","returnAnalysisValue","created","setInterval","Site","mobileThreshold","init","_this","window","resize","onResize","Earth","Overlay","Programacion","StreamChecker","EventChecker","fixWidows","each","string","html","replace","triggerEvent","eventName","detail","customEvent","CustomEvent","dispatchEvent","activeNavItem","desktopWidth","pageOverlay","getElementsByClassName","header","mobileToggle","mobileMenu","pageOpen","desktopPageClose","bindClicks","addEventListener","toggleMobile","i","length","openPage","closePage","toggleOverlay","body","classList","contains","remove","add","querySelector","pageName","target","getAttribute","activePage","activeDesktopNavItem","clientWidth","eventsPosts","JSON","parse","programacionEvents","scheduleArray","programacionContainer","fillEventsObject","addEventsToDom","forEach","scheduleEvent","eventMoment","moment","unix","parseInt","timestamp","year","month","monthNum","day","dayNum","hour","undefined","months","days","events","push","content","scheduleHTML","yearIndex","innerHTML","yearContent","createElement","innerText","makeEventsRow","monthIndex","monthContent","dayIndex","dayContent","eventObj","eventIndex","eventContent","className","container","id","rowContent","newRow","appendChild","canvasWidth","canvasHeight","textureUrl","themeUrl","initialCameraZ","isSafari","initFlatEarth","initThreeEarth","navigator","userAgent","match","style","webkitFilter","chrome","flatEarth","animateFlatEarth","handleOnClick","requestAnimationFrame","audioValue","transform","animate","camera","THREE","PerspectiveCamera","innerHeight","position","z","scene","Scene","group","Group","loadTexture","canvas","width","height","renderCanvas","togglePlay","texture","CanvasTexture","geometry","PlaneBufferGeometry","material","MeshBasicMaterial","map","overdraw","mesh","Mesh","y","rotation","x","Math","PI","renderer","CanvasRenderer","alpha","setClearColor","setPixelRatio","devicePixelRatio","setSize","domElement","TextureLoader","load","SphereGeometry","renderScene","lookAt","render","aspect","updateProjectionMatrix","statusUrl","statusCheckInterval","streamData","startChecker","checkStreamStatus","getJSON","fail","console","log","neverPlayed","fadeTime","volumeIncrement","playerContainer","playerElement","playerSrc","playButton","pauseButton","streamStatusText","nowPlayingText","marqueeHolder","handleOnlineStream","handleCanplay","handleOfflineStream","pause","setupAudioProcessing","audioContext","AudioContext","webkitAudioContext","audioSource","createMediaElementSource","crossOrigin","buildMarqueeContent","eventData","marqueeTextElem","nowPlayingWidth","intoWindow","round","marqueeContent","networkState","paused","fadeInterval","newVolume","clearInterval","eventUrl","eventCheckInterval","setViewportLargestDimension","viewporLargestDimension","dimension","size","featuredThumbnails","setBackground","fallbackImage","clearBackground","clearEvent","images","viewportLargestDimension","background","url","backgroundImage"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr, moment, WP, THREE, MobileDetect*/\n\n$(document).ready(function () {\n  Player = new Vue({\n    el: '#player-container',\n\n    data: {\n      streamUrl: 'http://streaming.radio.co/s0b5e9c02c/listen',\n      isStreaming: false,\n      isPlaying: false,\n      message: 'Hello Vue!',\n      stream: {},\n      event: {},\n      fftSize: 32,\n      freqBand: 1,\n      repeatMarquee: 1,\n    },\n\n    computed: {\n      marqueeText: function() {\n        var marqueeText =  typeof this.event.title === 'undefined' ? '' : this.event.title;\n\n        if(typeof this.stream.current_track !== 'undefined') {\n          marqueeText += ': ' + this.stream.current_track.title;\n        }\n\n        if(this.event.marqueeText) {\n          marqueeText += ' ' + this.event.marqueeText;\n        }\n\n        return marqueeText;\n\n      },\n\n      marqueeWidth: function() {\n      },\n\n\n    },\n\n    updated: function() {\n      var marqueeWidth  = document.getElementById('now-playing-marquee-holder').offsetWidth;\n      var nowPlayingWidth =  document.getElementById('now-playing').offsetWidth;\n\n      if(marqueeWidth * 3 > nowPlayingWidth) {\n        this.repeatMarquee += 1;\n      }\n\n    },\n\n    watch: {\n      marqueeText: function() {\n        this.repeatMarquee = 3;\n      },\n\n    },\n\n    methods: {\n      checkStatus: function() {\n        $.get('https://public.radio.co/stations/s0b5e9c02c/status', function(res) {\n          this.stream = res;\n\n          if(!this.isStreaming && this.stream.status === 'online') {\n            this.isStreaming = true;\n            this.initPlayer();\n          }\n\n        }.bind(this));\n      },\n\n      checkEvent: function() {\n        $.get(WP.siteUrl + '/wp-json/igv/current-event', function(res) {\n          this.event = res;\n        }.bind(this));\n      },\n\n      initPlayer: function() {\n\n        // Create audio source from <audio>\n        this.audio = new Howl({\n\n          src: this.streamUrl,\n          html5: true,\n          format: ['mp3'],\n        });\n\n        // Bind Events\n        // On load\n        this.audio.on('load', function(){\n          this.audio.play();\n        }.bind(this));\n\n        // On play\n        this.audio.on('play', function(){\n          this.isPlaying = true;\n        }.bind(this));\n\n        // On End\n        this.audio.on('end', function(){\n          this.isPlaying = false;\n        }.bind(this));\n\n        // On Mute\n        this.audio.on('volume', function(event){\n          this.isPlaying = Number(this.audio.volume());\n        }.bind(this));\n\n\n        // this.audioSource = this.audio.ctx.createMediaElementSource(this.playerElement);\n\n        // Create analyser node\n        this.audioAnalyser = Howler.ctx.createAnalyser();\n\n        // Set analyser settings\n        this.audioAnalyser.fftSize = this.fftSize;\n\n        // this.audioAnalyser.minDecibels = -90;\n        // this.audioAnalyser.maxDecibels = -10;\n\n        this.audioAnalyser.smoothingTimeConstant = 1;\n\n        // Init the anaylser data array\n        this.analyserData = new Uint8Array(this.audioAnalyser.frequencyBinCount);\n\n        // Conect Source to Analyser\n        Howler.masterGain.connect(this.audioAnalyser);\n        Howler.masterGain.gain.value = 1;\n\n        // Conect Analyser to destination. connectin to destination triggers the audio\n        this.audioAnalyser.connect(Howler.ctx.destination);\n\n        // Init the anaylser data array\n        this.analyserData = new Uint8Array(this.audioAnalyser.frequencyBinCount);\n\n      },\n\n      toggleMute: function() {\n        var volume = this.isPlaying ? 0 : 1;\n        this.audio.volume(volume);\n      },\n\n      getAnalyserValue: function() {\n\n        // If the audioContext is not defined we return 128 which is equal to no-sound\n        if (typeof this.audio === 'undefined') {\n          return 0;\n        }\n\n        // Pass anlyser data to _this.analyserData\n        this.audioAnalyser.getByteTimeDomainData(this.analyserData);\n\n        // Get analysis value\n        // Our return values here range from 0 - 256.\n        // Because it is a waveform, 0 and 256 are both full sound\n        // on the wave, and the midpoint 128 is full silence.\n        // We can think of it as a range from -1 - 1, with 128 at the 0 point.\n        var returnAnalysisValue = this.analyserData[this.freqBand];\n\n        // Here we invert values from 128 (silence) - 0 (sound), to become\n        // 0 (silence) - 128 (sound)\n        if (returnAnalysisValue < 128) {\n          returnAnalysisValue = 128 - returnAnalysisValue;\n          // or subtract 128 from values 128 - 256\n          // to get 0 (silence) - 128 (sound)\n        } else {\n          returnAnalysisValue -= 128;\n        }\n\n        // Make returnAnalysisValue be in the range of  0 - 1\n        returnAnalysisValue = returnAnalysisValue / 128;\n\n        return returnAnalysisValue;\n\n      },\n    },\n\n    created: function () {\n      this.checkStatus();\n      this.checkEvent();\n\n      setInterval(function () {\n        this.checkStatus();\n        this.checkEvent();\n      }.bind(this), 2000);\n    },\n\n  });\n});\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function() {\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      Site.Earth.init();\n      Site.Overlay.init();\n      Site.Player.init();\n      Site.Programacion.init();\n    });\n\n    Site.StreamChecker.init();\n    Site.EventChecker.init();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    Site.Earth.onResize();\n    Site.EventChecker.onResize();\n    Site.Overlay.onResize();\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function() {\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  triggerEvent: function(eventName, detail) {\n    var _this =  this;\n\n    var customEvent = new CustomEvent(eventName, {\n      detail: detail,\n    });\n\n    document.dispatchEvent(customEvent);\n  },\n};\n\nSite.Overlay = {\n  activeNavItem: null,\n  desktopWidth: 1024,\n\n  init: function() {\n    var _this = this;\n\n    // GET! ALL THE THINGS!\n    _this.pageOverlay = document.getElementsByClassName('page-overlay');\n\n    _this.header = document.getElementById('header');\n\n    _this.mobileToggle = document.getElementById('mobile-overlay-toggle');\n    _this.mobileMenu = document.getElementById('mobile-menu');\n\n    _this.pageOpen = document.getElementsByClassName('js-page-open');\n\n    _this.desktopPageClose = document.getElementsByClassName('desktop-page-close');\n\n    // BIND CLICKS!\n    _this.bindClicks();\n  },\n\n  bindClicks: function() {\n    var _this = this;\n\n    // bind the mobile toggle clicks!\n    _this.mobileToggle.addEventListener('click', _this.toggleMobile.bind(_this));\n\n    for (var i = 0; i < _this.pageOpen.length; i++) {\n      // bind the page nav item clicks!\n      _this.pageOpen[i].addEventListener('click', _this.openPage.bind(_this));\n    }\n\n    for (var i = 0; i < _this.desktopPageClose.length; i++) {\n      // bind the desktop page close X clicks!\n      _this.desktopPageClose[i].addEventListener('click', _this.closePage.bind(_this));\n    }\n  },\n\n  toggleOverlay: function() {\n    var _this = this;\n\n    if (document.body.classList.contains('overlay-active')) {\n      // if the overlay is showing: hide it\n      document.body.classList.remove('overlay-active');\n    } else {\n      // otherwise: show it\n      document.body.classList.add('overlay-active');\n    }\n\n  },\n\n  toggleMobile: function() {\n    var _this = this;\n\n    // on mobile, the same button closes pages,\n    // and also toggles the mobile menu\n\n    // if there is a page open\n    if (document.querySelector('.page-active') !== null) {\n      // close it\n      _this.closePage();\n      // and hide the overlay\n      _this.toggleOverlay();\n\n    // otherwise, we're toggling the menu\n    } else {\n\n      // if the menu is open\n      if (_this.mobileMenu.classList.contains('active')) {\n        // close it\n        _this.mobileMenu.classList.remove('active');\n      } else {\n        // otherwise, open it\n        _this.mobileMenu.classList.add('active');\n      }\n    }\n\n    // and finally, hide or show the overlay\n    _this.toggleOverlay();\n  },\n\n  openPage: function(event) {\n    var _this = this;\n\n    // get the page name from the\n    // clicked <a> data-page attribute\n    var pageName = event.target.getAttribute('data-page');\n\n    // find the page container with that ID\n    _this.activePage = document.getElementById('page-' + pageName);\n    // open the page!\n    _this.activePage.classList.add('page-active');\n\n    // set the <li> parent of the target <a>\n    // as the active nav item. this displays\n    // in the header as our page title\n    _this.activeDesktopNavItem = document.getElementById('desktop-nav-' + pageName);\n    _this.activeDesktopNavItem.classList.add('active');\n\n    // if the mobile menu is active, we know this\n    // click was on a mobile nav item, and we know\n    // the overlay is already active\n    if (_this.mobileMenu.classList.contains('active')) {\n      // hide the menu\n      _this.mobileMenu.classList.remove('active');\n    } else {\n      // otherwise it was a desktop nav item, so\n      // we need to show the overlay\n      _this.toggleOverlay();\n    }\n  },\n\n  closePage: function() {\n    var _this = this;\n\n    // unset the active <li> nav item\n    _this.activeDesktopNavItem.classList.remove('active');\n\n    // hide the active page\n    _this.activePage.classList.remove('page-active');\n\n    // hide the overlay\n    _this.toggleOverlay();\n  },\n\n  onResize: function() {\n    var _this = this;\n    var windowWidth = document.body.clientWidth;\n\n    // if we're on desktop size\n    // and the mobile menu is active\n    if (windowWidth >= _this.desktopWidth && _this.mobileMenu.classList.contains('active')) {\n      // hide the menu\n      _this.mobileMenu.classList.remove('active');\n      // and hide the overlay\n      _this.toggleOverlay();\n    }\n  }\n};\n\nSite.Programacion = {\n  // parse JSON event posts object from Wordpress\n  eventsPosts: JSON.parse(WP.programacionEvents),\n  scheduleArray: [],\n  init: function() {\n    var _this = this;\n\n    // Set programacion container\n    _this.programacionContainer =  document.getElementById('programacion-container');\n\n    // Check is theres events scheduled\n    if (_this.eventsPosts.length) {\n\n      // Loop through Years -> Months -> Days -> Events\n      _this.fillEventsObject();\n\n      // Add schedule to DOM\n      _this.addEventsToDom();\n    }\n  },\n\n  fillEventsObject: function() {\n    var _this = this;\n\n    // Iterate thru each event\n    _this.eventsPosts.forEach(function(scheduleEvent) {\n      // Generate moment from timestamp in user local timezone\n      var eventMoment = moment.unix(parseInt(scheduleEvent.timestamp));\n\n      // Parse date/time data\n      var year = eventMoment.format('YYYY');\n      var month = eventMoment.format('MMMM');\n      var monthNum = eventMoment.format('M');\n      var day = eventMoment.format('dddd Do');\n      var dayNum = eventMoment.format('D');\n      var hour = eventMoment.format('H:mm');\n\n      // Create this Year object if missing in schedule array\n      if (_this.scheduleArray[year] === undefined) {\n        _this.scheduleArray[year] = {\n          year: year,\n          months: []\n        };\n      }\n\n      // Create this Month object if missing in Year\n      if (_this.scheduleArray[year].months[monthNum] === undefined) {\n        _this.scheduleArray[year].months[monthNum] = {\n          month: month,\n          days: []\n        };\n      }\n\n      // Create this Day object if missing in Month\n      if (_this.scheduleArray[year].months[monthNum].days[dayNum] === undefined) {\n        _this.scheduleArray[year].months[monthNum].days[dayNum] = {\n          day: day,\n          events: []\n        };\n      }\n\n      // Push Event object to events array\n      _this.scheduleArray[year].months[monthNum].days[dayNum].events.push({\n        hour: hour,\n        title: scheduleEvent.title,\n        content: scheduleEvent.content\n      });\n    });\n  },\n\n  addEventsToDom: function() {\n    var _this = this;\n    var scheduleHTML = '';\n\n    // Make Years\n    _this.scheduleArray.forEach(function(year, yearIndex) {\n\n      // Clear container (aka remove the empty schedule text)\n      _this.programacionContainer.innerHTML = '';\n\n      // create content element\n      var yearContent = document.createElement('h3');\n      // fill with year\n      yearContent.innerText = year.year;\n      yearContent.classList.add('font-averta');\n\n      // add Year row to HTML\n      scheduleHTML += _this.makeEventsRow(\n        // parent element\n        _this.programacionContainer,\n        // row id\n        yearIndex,\n        // row content\n        yearContent\n      );\n\n      // Make Months\n      year.months.forEach(function(month, monthIndex) {\n\n        // create content element\n        var monthContent = document.createElement('h3');\n        // fill with month\n        monthContent.innerText = month.month;\n        monthContent.classList.add('font-averta');\n\n        // make Month row\n        _this.makeEventsRow(\n          document.getElementById(yearIndex),\n          yearIndex + '-' + monthIndex,\n          monthContent\n        );\n\n        // Make Days\n        month.days.forEach(function(day, dayIndex) {\n\n          // create content element\n          var dayContent = document.createElement('h3');\n          // fill with day\n          dayContent.innerText = day.day;\n          dayContent.classList.add('font-averta');\n\n          // make Day row\n          _this.makeEventsRow(\n            document.getElementById(yearIndex + '-' + monthIndex),\n            yearIndex + '-' + monthIndex + '-' + dayIndex,\n            dayContent\n          );\n\n          // Make Events\n          day.events.forEach(function(eventObj, eventIndex) {\n\n            // create content element\n            var eventContent = document.createElement('div');\n            // set element element class\n            eventContent.className = 'programacion-event';\n            // fill with event info\n            eventContent.innerHTML = '<div class=\"programacion-event-hour font-averta\">' + eventObj.hour + '</div><div class=\"programacion-event-info\"><h2 class=\"font-aileron-semibold\">' + eventObj.title + '</h2>' + eventObj.content;\n\n            // make Event row\n            _this.makeEventsRow(\n              document.getElementById(yearIndex + '-' + monthIndex + '-' + dayIndex),\n              yearIndex + '-' + monthIndex + '-' + dayIndex + '-' + eventIndex,\n              eventContent\n            );\n\n          });\n\n        });\n\n      });\n\n    });\n  },\n\n  // Generate DOM for an events row and append it:\n  // <div id={id} class=\"programacion-row\">\n  //   {rowContent}\n  // </div>\n  makeEventsRow: function(container, id, rowContent) {\n    var _this = this;\n\n    // Create row element\n    var newRow = document.createElement('div');\n\n    // Set attributes\n    newRow.id = id;\n    newRow.className = 'programacion-row';\n    newRow.appendChild(rowContent);\n\n    // Append row to container\n    container.appendChild(newRow);\n  }\n};\n\nSite.Earth = {\n  canvasWidth: 128,\n  canvasHeight: 128,\n  textureUrl: WP.themeUrl + '/dist/img/earth_texture.jpg',\n  initialCameraZ: 1000,\n  init: function() {\n    var _this = this;\n\n    if (_this.isSafari()) {\n      _this.initFlatEarth();\n    } else {\n      _this.initThreeEarth();\n    }\n\n  },\n\n  isSafari: function() {\n    return !!navigator.userAgent.match(/safari/i)\n      && !navigator.userAgent.match(/chrome/i)\n      && typeof document.body.style.webkitFilter !== \"undefined\"\n      && !window.chrome;\n  },\n\n  initFlatEarth: function() {\n    var _this = this;\n\n    _this.flatEarth = document.getElementById('earth-flat');\n\n    _this.flatEarth.classList.remove('u-hidden');\n\n    _this.animateFlatEarth = _this.animateFlatEarth.bind(_this);\n\n    _this.animateFlatEarth();\n\n    // Bind click\n    _this.flatEarth.addEventListener('click', _this.handleOnClick.bind(_this));\n\n  },\n\n  animateFlatEarth: function() {\n    var _this = this;\n\n    window.requestAnimationFrame(_this.animateFlatEarth);\n\n    // Get analyser audio value\n    // The value goes from 0 to 1\n    var audioValue = Site.Player.getAnalyserValue();\n\n    audioValue *= 3;\n\n    audioValue = 1 + audioValue;\n\n    _this.flatEarth.style.transform = 'scale(' + audioValue + ')';\n\n  },\n\n  initThreeEarth: function() {\n    var _this = this;\n\n    // Bind Animate function\n    _this.animate = _this.animate.bind(_this);\n\n    _this.container = document.getElementById('earth-container');\n\n    // -- Set Three stuff\n\n    // Set camera\n    _this.camera = new THREE.PerspectiveCamera( 60, document.body.clientWidth / window.innerHeight, 1, 2000 );\n    _this.camera.position.z = _this.initialCameraZ;\n\n    // Set Scene\n    _this.scene = new THREE.Scene();\n\n    // Set Group\n    _this.group = new THREE.Group();\n\n    // Add Group to the scene\n    _this.scene.add( _this.group );\n\n    // Load earth texture\n    _this.loadTexture();\n\n    // Create canvas element\n    _this.canvas = document.createElement( 'canvas' );\n\n    // Set Canvas size\n    _this.canvas.width = _this.canvasWidth;\n    _this.canvas.height = _this.canvasHeight;\n\n    // Render canvas\n    _this.renderCanvas();\n\n    // Animate\n    _this.animate();\n\n    // Bind click\n    _this.container.addEventListener('click', _this.handleOnClick.bind(_this));\n  },\n\n  handleOnClick: function() {\n    var _this = this;\n\n    Site.Player.togglePlay();\n  },\n\n  renderCanvas: function() {\n    var _this = this;\n\n    var texture = new THREE.CanvasTexture( _this.canvas );\n    var geometry = new THREE.PlaneBufferGeometry( 300, 300, 3, 3 );\n    var material = new THREE.MeshBasicMaterial( { map: texture, overdraw: 0.5 } );\n    var mesh = new THREE.Mesh( geometry, material );\n\n    mesh.position.y = - 250;\n    mesh.rotation.x = - Math.PI / 2;\n    _this.group.add( mesh );\n\n    _this.renderer = new THREE.CanvasRenderer({ alpha: true });\n    _this.renderer.setClearColor( 0x000000, 0 );\n    _this.renderer.setPixelRatio( window.devicePixelRatio );\n    _this.renderer.setSize( document.body.clientWidth, window.innerHeight );\n    _this.container.appendChild( _this.renderer.domElement );\n  },\n\n  loadTexture: function() {\n    var _this = this;\n\n    var loader = new THREE.TextureLoader();\n\n    loader.load(_this.textureUrl, function (texture) {\n      var geometry = new THREE.SphereGeometry( 200, 20, 20 );\n      var material = new THREE.MeshBasicMaterial( { map: texture, overdraw: 0.5 } );\n      var mesh = new THREE.Mesh( geometry, material );\n      _this.group.add( mesh );\n    });\n  },\n\n  animate: function() {\n    var _this = this;\n\n    window.requestAnimationFrame(_this.animate);\n\n    _this.renderScene();\n  },\n\n  renderScene: function() {\n    var _this = this;\n\n    _this.camera.lookAt( _this.scene.position );\n    _this.group.rotation.y += 0.005;\n\n    // Get analyser audio value\n    // The value goes from 0 to 1\n    var audioValue = Site.Player.getAnalyserValue();\n\n    // because the larger Z is the smaller the globe is\n    // we need turn the value to be from 1 to 0\n    audioValue = 1 - audioValue;\n\n    // Set new camera z position\n    _this.camera.position.z = audioValue * _this.initialCameraZ;\n\n    // Re-render scene\n    _this.renderer.render( _this.scene, _this.camera );\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    if (typeof _this.camera !== 'undefined') {\n      _this.camera.aspect = document.body.clientWidth / window.innerHeight;\n      _this.camera.updateProjectionMatrix();\n      _this.renderer.setSize( document.body.clientWidth, window.innerHeight );\n    }\n  }\n};\n\nSite.StreamChecker = {\n  statusUrl: 'https://public.radio.co/stations/s0b5e9c02c/status',\n  statusCheckInterval: 5000,\n  streamData: null,\n  init: function() {\n    var _this = this;\n\n    _this.startChecker();\n  },\n\n  startChecker: function() {\n    var _this = this;\n\n\n    _this.checkStreamStatus();\n\n    // Start checker on an interval\n    setInterval(function() {\n      _this.checkStreamStatus();\n    }, _this.statusCheckInterval);\n  },\n\n  // Check the stream status thru ajax and change the player accordingly\n  checkStreamStatus: function() {\n    var _this = this;\n\n    // Make the ajax request\n    $.getJSON(_this.statusUrl, function(data) {\n\n      // Save data in a cache var, just in case\n      _this.streamData = data.status;\n\n      // Check if the stream is offline\n      if (data.status === 'offline') {\n\n        // Trigger the event\n        Site.triggerEvent('streamoffline', data);\n\n      } else if (data.status === 'online')  {  // else  (stream is online)\n\n        // Trigger the event\n        Site.triggerEvent('streamonline', data);\n      }\n    })\n    .fail( function() {\n      // Trigger the event\n      Site.triggerEvent('streamoffline');\n\n      console.log('Radio.co seems to be unresponsive');\n\n    });\n\n  },\n\n};\n\nSite.Player = {\n  neverPlayed: true,\n  fadeTime:  100,\n  fftSize: 32,\n  freqBand: 1,\n  streamUrl: 'http://streaming.radio.co/s0b5e9c02c/listen',\n  streamData: {},\n  isPlaying: false,\n  init: function() {\n    var _this = this;\n\n    // Calculate the volume increment\n    _this.volumeIncrement = 1 / (_this.fadeTime / 50);\n\n    // Player DOM elements\n    _this.playerContainer =  document.getElementById('player-container');\n    _this.playerElement =  document.getElementById('player');\n    _this.playerSrc =  document.getElementById('player-src');\n    _this.playButton =  document.getElementById('play-button');\n    _this.pauseButton =  document.getElementById('pause-button');\n    _this.streamStatusText =  document.getElementById('stream-status');\n    _this.nowPlayingText =  document.getElementById('now-playing');\n    _this.marqueeHolder = document.getElementById('now-playing-marquee-holder');\n\n    // Bind event handlers\n    _this.handleOnlineStream = _this.handleOnlineStream.bind(_this);\n    _this.handleCanplay = _this.handleCanplay.bind(_this);\n    _this.handleOfflineStream = _this.handleOfflineStream.bind(_this);\n\n    // Subscribe to stream events\n    document.addEventListener('streamonline', _this.handleOnlineStream);\n    document.addEventListener('streamoffline', _this.handleOfflineStream);\n\n    // Subscribe to clic on player controls\n    _this.playButton.addEventListener('click', _this.play.bind(_this));\n    _this.pauseButton.addEventListener('click', _this.pause.bind(_this));\n  },\n\n  /*\n   * Setup all web audio stuff.\n   */\n  setupAudioProcessing: function() {\n    var _this = this;\n\n    // Set Audio Context\n    _this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\n    // Create audio source from <audio>\n    _this.audioSource = _this.audioContext.createMediaElementSource(_this.playerElement);\n\n    // Create analyser node\n    _this.audioAnalyser = _this.audioContext.createAnalyser();\n\n    // Set analyser settings\n    _this.audioAnalyser.fftSize = _this.fftSize;\n    /*\n    _this.audioAnalyser.minDecibels = -90;\n    _this.audioAnalyser.maxDecibels = -10;\n    */\n    _this.audioAnalyser.smoothingTimeConstant = 1;\n\n    // Init the anaylser data array\n    _this.analyserData = new Uint8Array(_this.audioAnalyser.frequencyBinCount);\n\n    // Conect Source to Analyser\n    _this.audioSource.connect(_this.audioAnalyser);\n\n    // Conect Analyser to destination. connectin to destination triggers the audio\n    _this.audioAnalyser.connect(_this.audioContext.destination);\n\n  },\n\n  handleOnlineStream: function(event) {\n    var _this = this;\n\n    if (typeof _this.streamData.current_track === 'undefined' || event.detail.current_track.title !== _this.streamData.current_track.title) {\n\n      _this.streamData = event.detail;\n\n      // Add class `online` to the player container\n      _this.playerContainer.classList.add('online');\n\n      // Check if player src is empty\n      if (_this.playerSrc.src === '') {\n\n        // Add src\n        _this.playerSrc.src = _this.streamUrl;\n\n        // Disable player CORS restriction\n        _this.playerElement.crossOrigin = 'anonymous';\n\n        // Load src\n        _this.playerElement.load();\n\n      }\n\n      // Update player status\n      _this.streamStatusText.innerHTML = 'Ahora: ';\n\n      // We subscribe to the `canplay` event from the player\n      _this.playerElement.addEventListener('canplay', _this.handleCanplay);\n\n    }\n\n    // Update marquee text\n    _this.buildMarqueeContent(_this.streamData.current_track.title);\n  },\n\n  buildMarqueeContent: function(marqueeText) {\n    var _this = this;\n\n    // Default value for marqueeText\n    marqueeText = typeof marqueeText === 'undefined' ? '' : marqueeText;\n\n    // get width of marquee holder\n    var marqueeWidth = _this.marqueeHolder.offsetWidth;\n\n    // Check if event title is available\n    if (Site.EventChecker.eventData.title) {\n      // Append event title to the marquee text\n      marqueeText = Site.EventChecker.eventData.title + ': ' + marqueeText;\n    }\n\n    // Check if marquee append text is available\n    if (Site.EventChecker.eventData.marqueeText) {\n      // Append  marquee text\n      marqueeText +=  ' ' + Site.EventChecker.eventData.marqueeText;\n    }\n\n    // assemble single marquee text element\n    var marqueeTextElem = '<span class=\"now-playing-text\">' + marqueeText + '</span>';\n\n    // get width of single marquee text element\n    _this.nowPlayingText.innerHTML = marqueeTextElem;\n    var nowPlayingWidth = _this.nowPlayingText.offsetWidth;\n\n    // how many times does marquee text go fit into marquee width\n    var intoWindow = Math.round( marqueeWidth / nowPlayingWidth );\n\n    // assemble marquee content\n    var marqueeContent = '<span class=\"now-playing-text-holder\">';\n\n    // repeat content for 4 times marquee width\n    for (var i = 0; i < (intoWindow * 4); i++) {\n      marqueeContent = marqueeContent + marqueeTextElem;\n    }\n\n    // add content to marquee\n    _this.nowPlayingText.innerHTML = marqueeContent + '</span>';\n  },\n\n  handleCanplay: function() {\n    var _this = this;\n\n    // If the player has never started playing\n    if (_this.neverPlayed) {\n\n      // Play the player\n      _this.play();\n\n      // Setup Audio processing\n      _this.setupAudioProcessing();\n\n    }\n\n  },\n\n  // Returns analyser data\n  getAnalyserValue: function() {\n    var _this = this;\n\n    // If the audioContext is not defined we return 128 which is equal to no-sound\n    if (_this.audioContext === undefined) {\n      return 0;\n    }\n\n    // Pass anlyser data to _this.analyserData\n    _this.audioAnalyser.getByteTimeDomainData(_this.analyserData);\n\n    // Get analysis value\n    // Our return values here range from 0 - 256.\n    // Because it is a waveform, 0 and 256 are both full sound\n    // on the wave, and the midpoint 128 is full silence.\n    // We can think of it as a range from -1 - 1, with 128 at the 0 point.\n    var returnAnalysisValue = _this.analyserData[_this.freqBand];\n\n    // Here we invert values from 128 (silence) - 0 (sound), to become\n    // 0 (silence) - 128 (sound)\n    if (returnAnalysisValue < 128) {\n      returnAnalysisValue = 128 - returnAnalysisValue;\n    // or subtract 128 from values 128 - 256\n    // to get 0 (silence) - 128 (sound)\n    } else {\n      returnAnalysisValue -= 128;\n    }\n\n    // Make returnAnalysisValue be in the range of  0 - 1\n    returnAnalysisValue = returnAnalysisValue / 128;\n\n    return returnAnalysisValue;\n\n  },\n\n  handleOfflineStream: function() {\n    var _this = this;\n\n    // Remove `online` class from the player container\n    _this.playerContainer.classList.remove('online');\n\n    // Update marquee status\n    _this.streamStatusText.innerHTML = 'Sigue: ';\n\n    // Pause the player\n    _this.pause();\n\n    // Update marquee text\n    _this.buildMarqueeContent();\n  },\n\n  play: function() {\n    var _this = this;\n\n    if (_this.playerElement.networkState !== 3) {\n\n      // Reset volume\n      _this.playerElement.volume = 0;\n\n      if ( _this.playerElement.paused) {\n\n        // Play audio element\n        _this.playerElement.play();\n\n      }\n\n      // Add `playing` class to player container\n      _this.playerContainer.classList.add('playing');\n\n      _this.isPlaying = true;\n\n      _this.neverPlayed = false;\n\n      // Fade in the volume\n      var fadeInterval = setInterval( function() {\n        var newVolume = _this.playerElement.volume + _this.volumeIncrement;\n\n        if (newVolume > 1) {\n          newVolume = 1;\n        }\n\n        _this.playerElement.volume = newVolume;\n\n        if (_this.playerElement.volume >= 1) {\n          // Clear the interval\n          clearInterval(fadeInterval);\n\n        }\n      }, 50);\n    }\n  },\n\n  pause: function() {\n    var _this = this;\n\n    // Mute the player instead of pause to keep the stream in sync\n    // because pause doesn't exist in live radio\n    _this.playerElement.volume = 0;\n\n    // Remove `playing` class from the player container\n    _this.playerContainer.classList.remove('playing');\n\n    _this.isPlaying = false;\n  },\n\n  togglePlay: function() {\n    var _this = this;\n\n    if (_this.isPlaying) {\n      _this.pause();\n    } else {\n      _this.play();\n    }\n  },\n};\n\nSite.EventChecker = {\n  eventUrl: WP.siteUrl + '/wp-json/igv/current-event',\n  eventCheckInterval: 5000,\n  eventData: {},\n  init: function() {\n    var _this = this;\n\n    // Set viewport orientation\n    _this.setViewportLargestDimension();\n\n    // Bind orientationchange\n    _this.setViewportLargestDimension = _this.setViewportLargestDimension.bind(_this);\n\n    // Start checker\n    _this.startChecker();\n  },\n\n  setViewportLargestDimension: function() {\n    var _this = this;\n\n    // Check if height is larger than width\n    if (window.innerHeight > document.body.clientWidth) {\n      _this.viewporLargestDimension = {\n        dimension: 'height',\n        size: window.innerHeight\n      };\n\n    } else {\n      _this.viewporLargestDimension = {\n        dimension: 'width',\n        size: document.body.clientWidth,\n      };\n\n    }\n\n  },\n\n  startChecker: function() {\n    var _this = this;\n\n    // Check the current event\n    _this.checkEvent();\n\n    // Start checker on an interval\n    setInterval(function() {\n      _this.checkEvent();\n    }, _this.eventCheckInterval);\n  },\n\n  // Check the current/next event and update background image and show title\n  checkEvent: function() {\n    var _this = this;\n\n    // Make the ajax request\n    $.getJSON(_this.eventUrl, function(data) {\n      if (data) {\n\n        // Save event data\n        _this.eventData = data;\n\n        // Check if new data is different from current one\n        if (_this.eventData['title'] !== data['title']) {\n\n          // Check if data comes with thumbanils\n          if (data.featuredThumbnails) {\n            // Set background image\n            _this.setBackground(data.featuredThumbnails);\n\n          } else {\n            // Check if we have a fallback image\n            if (typeof WP.fallbackImage !== undefined) {\n              // Set fallback image as background\n              _this.setBackground(WP.fallbackImage);\n\n            } else {\n              // Clear background\n              _this.clearBackground();\n\n            }\n          }\n\n        }\n\n      } else {\n\n        // Clear event stuff: background, title, data\n        _this.clearEvent();\n\n      }\n    });\n  },\n\n  setBackground: function(images) {\n    var _this = this;\n\n    var viewportLargestDimension = _this.viewporLargestDimension.size;\n\n    // We set largest image as fallback (last in the array)\n    var background = images[images.length - 1].url;\n\n    // Iterate thru images to find the smallest image capable to fill the screen\n    for(var i = 0; i < images.length; i++) {\n\n      var imageDimension = images[i][_this.viewporLargestDimension.dimension];\n\n      // Check the viewport largest dimension against the image dimension\n      if (imageDimension > viewportLargestDimension) {\n        background = images[i].url;\n        break;\n      }\n    }\n\n    // Set image as background-image in the body\n    document.body.style.backgroundImage = 'url(' + background + ')';\n  },\n\n  // Clear event stuff: background, title, data\n  clearEvent: function() {\n    var _this = this;\n\n    // Set event data to false\n    _this.eventData = false;\n\n    // Clear background\n    _this.clearBackground();\n  },\n\n  clearBackground: function() {\n    var _this = this;\n\n    document.body.style.backgroundImage = '';\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.setViewportLargestDimension();\n\n    // If event data available\n    if(_this.eventData) {\n      // Set background\n      _this.setBackground(_this.eventData.featuredThumbnails);\n    }\n  }\n};\n//Site.init();\n"]}