Site={mobileThreshold:601,init:function(){var _this=this;$(window).resize(function(){_this.onResize()}),$(document).ready(function(){Site.Player.init(),Site.Programacion.init()}),Site.StreamChecker.init()},onResize:function(){},fixWidows:function(){$(".js-fix-widows").each(function(){var string=$(this).html();string=string.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(string)})}},Site.Programacion={eventsPosts:JSON.parse(WP.programacionEvents),scheduleArray:[],programacionContainer:document.getElementById("page-programacion"),init:function(){var _this=this;_this.fillEventsObject(),_this.addEventsToDom()},fillEventsObject:function(){var _this=this;_this.eventsPosts.forEach(function(el){var eventMoment=moment.unix(parseInt(el.timestamp)),year=eventMoment.format("YYYY"),month=eventMoment.format("MMMM"),monthNum=eventMoment.format("M"),day=eventMoment.format("dddd Do"),dayNum=eventMoment.format("D"),hour=eventMoment.format("H:mm");_this.scheduleArray[year]||(_this.scheduleArray[year]={year:year,months:[]}),void 0===_this.scheduleArray[year].months[monthNum]&&(_this.scheduleArray[year].months[monthNum]={month:month,days:[]}),void 0===_this.scheduleArray[year].months[monthNum].days[dayNum]&&(_this.scheduleArray[year].months[monthNum].days[dayNum]={day:day,events:[]}),_this.scheduleArray[year].months[monthNum].days[dayNum].events.push({hour:hour,title:el.title,content:el.content})})},addEventsToDom:function(){var _this=this,scheduleHTML="";_this.scheduleArray.forEach(function(year,yearIndex){var yearContent=document.createElement("h3");yearContent.innerText=year.year,scheduleHTML+=_this.makeEventsRow(_this.programacionContainer,yearIndex,yearContent),year.months.forEach(function(month,monthIndex){var monthContent=document.createElement("h3");monthContent.innerText=month.month,_this.makeEventsRow(document.getElementById(yearIndex),yearIndex+"-"+monthIndex,monthContent),month.days.forEach(function(day,dayIndex){var dayContent=document.createElement("h3");dayContent.innerText=day.day,_this.makeEventsRow(document.getElementById(yearIndex+"-"+monthIndex),yearIndex+"-"+monthIndex+"-"+dayIndex,dayContent),day.events.forEach(function(eventObj,eventIndex){var eventContent=document.createElement("div");eventContent.className="programacion-event",eventContent.innerHTML='<div class="programacion-event-hour">'+eventObj.hour+'</div><div class="programacion-event-info"><h2>'+eventObj.title+"</h2>"+eventObj.content,_this.makeEventsRow(document.getElementById(yearIndex+"-"+monthIndex+"-"+dayIndex),yearIndex+"-"+monthIndex+"-"+dayIndex+"-"+eventIndex,eventContent)})})})})},makeEventsRow:function(container,id,rowContent){var newRow=document.createElement("div");newRow.id=id,newRow.className="programacion-row",newRow.appendChild(rowContent),container.appendChild(newRow)}},Site.StreamChecker={statusUrl:"https://public.radio.co/stations/s0b5e9c02c/status",statusCheckInterval:5e3,streamData:null,init:function(){this.startChecker()},startChecker:function(){var _this=this;_this.checkStreamStatus(),setInterval(function(){_this.checkStreamStatus()},_this.statusCheckInterval)},checkStreamStatus:function(){var _this=this;$.getJSON(_this.statusUrl,function(data){_this.streamData=data.status,"offline"===data.status?_this.triggerEvent("streamoffline",data):"online"===data.status&&_this.triggerEvent("streamonline",data)}).fail(function(){_this.triggerEvent("streamoffline"),console.log("Radio.co seems to be unresponsive")})},triggerEvent:function(eventName,detail){console.log("event triggered: ",eventName);var customEvent=new CustomEvent(eventName,{detail:detail});document.dispatchEvent(customEvent)}},Site.Player={neverPlayed:!0,fadeTime:2e3,streamUrl:"http://streaming.radio.co/s0b5e9c02c/listen",init:function(){var _this=this;_this.playerContainer=document.getElementById("player-container"),_this.playerElement=document.getElementById("player"),_this.playerSrc=document.getElementById("player-src"),_this.playButton=document.getElementById("play-button"),_this.pauseButton=document.getElementById("pause-button"),_this.streamStatusText=document.getElementById("stream-status"),_this.nowPlayingText=document.getElementById("now-playing"),_this.handleOnlineStream=_this.handleOnlineStream.bind(_this),_this.handleCanplay=_this.handleCanplay.bind(_this),_this.handleOfflineStream=_this.handleOfflineStream.bind(_this),document.addEventListener("streamonline",_this.handleOnlineStream),document.addEventListener("streamoffline",_this.handleOfflineStream),_this.playButton.addEventListener("click",_this.play.bind(_this)),_this.pauseButton.addEventListener("click",_this.pause.bind(_this)),_this.volumeIncrement=1/(_this.fadeTime/50)},handleOnlineStream:function(event){var _this=this,data=event.detail;_this.playerContainer.classList.add("online"),(""===_this.playerSrc.src||_this.playerElement.paused)&&(_this.playerSrc.src=_this.streamUrl,_this.playerElement.load()),_this.streamStatusText.innerHTML="Ahora: ",_this.nowPlayingText.innerHTML=data.current_track.title,_this.neverPlayed&&_this.playerElement.addEventListener("canplay",_this.handleCanplay)},handleCanplay:function(event){var _this=this;_this.play(),event.target.removeEventListener(event.type,_this.handleCanplay)},handleOfflineStream:function(){var _this=this;_this.playerContainer.classList.remove("online"),_this.streamStatusText.innerHTML="Siguiente: ",_this.nowPlayingText.innerHTML="the upcoming show that has to be requested thru ajax",_this.pause()},play:function(){var _this=this;if(3!==_this.playerElement.networkState){_this.playerElement.volume=0,_this.playerElement.play(),_this.playerContainer.classList.add("playing"),_this.neverPlayed=!1;var fadeInterval=setInterval(function(){var newVolume=_this.playerElement.volume+_this.volumeIncrement;newVolume>1&&(newVolume=1),_this.playerElement.volume=newVolume,_this.playerElement.volume>=1&&clearInterval(fadeInterval)},50)}},pause:function(){var _this=this;_this.playerElement.pause(),_this.playerContainer.classList.remove("playing")}},Site.init();
//# sourceMappingURL=main.min.js.map
